function f(o,m,i){window.enmity.settings.set(o,m,i)}function h(o,m,i){return window.enmity.settings.get(o,m,i)}function D(o){window.enmity.plugins.registerPlugin(o)}function p(...o){return window.enmity.modules.getByProps(...o)}function L(...o){return window.enmity.modules.getByName(...o)}window.enmity.modules.common;const N=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const H=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const k=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function I(o){return window.enmity.patcher.create(o)}const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const B=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch;const P=e.Text;e.TextInput,e.TouchableHighlight;const x=e.TouchableOpacity;e.TouchableWithoutFeedback,e.Touchable,e.View,e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon;const G=e.FormInput;e.FormLabel,e.FormRadio;const A=e.FormRow,R=e.FormSection;e.FormSelect,e.FormSubLabel,e.FormSwitch,e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;var V="Moyai",O="1.2.3",j="\u{1F5FF}",U=[{name:"Fiery",id:"890228870559698955"},{name:"Egg",id:"1015049434607927306"}],W={plugin:"https://github.com/Egg-Man-Real/Moyai/releases/latest/download/Moyai.js",manifest:"https://github.com/Egg-Man-Real/Moyai/releases/latest/download/manifest.json",changelog:"Fix Moyai Count",source:"https://github.com/Egg-Man-Real/Moyai"},z="#F47FFE",r={name:V,version:O,description:j,authors:U,updater:W,color:z};const K=p("DRMType","FilterType").default;function Q({settings:o}){const[m,i]=n.useState(!0),c=k.createThemedStyleSheet({item:{color:N.ThemeColorMap.HEADER_PRIMARY}});return n.useEffect(()=>{},[]),n.createElement(B,null,n.createElement(R,{title:"\u{1F5FF}"},n.createElement(G,{title:"Volume",placeholder:"69",keyboardType:"numeric",value:o.get("volume"),onChange:u=>o.set("volume",u)}),n.createElement(x,{onPress:()=>i(!1)},n.createElement(A,{label:"Test volume"}))),n.createElement(R,{title:"\u{1F5FF}"},n.createElement(A,{label:"Moyai Counter",subLabel:"This is probably innacurate (aka \u{1F5FF}\u{1F5FF}\u{1F5FF}\u{1F5FF})",trailing:()=>n.createElement(P,{style:c.item},Number(h(r.name,"moyaiCounter",0)))})),n.createElement(K,{source:{uri:"https://github.com/Egg-Man-Real/Moyai/raw/main/src/boom.mp4"},audioOnly:!0,paused:m,repeat:!0,onEnd:()=>i(!0),volume:Number(o.get("volume"))}))}const E=p("_currentDispatchActionType","_subscriptions","_actionHandlers","_waitQueue"),Y=L("ChatBanner",{default:!1}),$=p("DRMType","FilterType").default,q=p("uploadLocalFiles"),l=I("moyai");function M(o){return o=o.toLowerCase(),["\u{1F5FF}","moyai","moai","boom","vine","\u{1F4A5}","*\u200D*"].some(m=>o.includes(m))}const J={...r,onStart(){h(r.name,"volume")||f(r.name,"volume","1");let o=0;const m=3,i=()=>{var c,u,s;try{o++;for(const a of["MESSAGE_CREATE","MESSAGE_UPDATE","MESSAGE_REACTION_ADD"])try{E.dispatch({type:a,message:{}})}catch(w){console.log(`[${r.name} Dispatch Error]`,w)}const S=(c=E._actionHandlers._orderedActionHandlers)==null?void 0:c.MESSAGE_CREATE.find(a=>a.name==="MessageStore"),d=(u=E._actionHandlers._orderedActionHandlers)==null?void 0:u.MESSAGE_UPDATE.find(a=>a.name==="MessageStore"),v=(s=E._actionHandlers._orderedActionHandlers)==null?void 0:s.MESSAGE_REACTION_ADD.find(a=>a.name==="MessageStore");l.instead(Y,"default",(a,w,_)=>{const b=w[0].channel.id,[y,T]=n.useState(!0);let g;return l.before(S,"actionHandler",(F,t,C)=>{t[0].channelId===b&&t[0].message.content&&M(t[0].message.content)&&(g.seek(0),y&&T(!1),t[0].message.content=t[0].message.content.replace("*\u200D*"," \u{1F5FF}"))}),l.before(d,"actionHandler",(F,t,C)=>{t[0].channelId===b&&t[0].message.content&&M(t[0].message.content)&&(g.seek(0),y&&T(!1),t[0].message.content=t[0].message.content.replace("*\u200D*"," \u{1F5FF}"))}),l.after(v,"actionHandler",(F,t,C)=>{t[0].channelId===b&&M(t[0].emoji.name)&&(g.seek(0),y&&T(!1),f(r.name,"moyaiCounter",Number(h(r.name,"moyaiCounter",0))+1))}),n.createElement(n.Fragment,null,_.apply(a,w),n.createElement($,{ref:F=>{g=F},source:{uri:"https://github.com/Egg-Man-Real/Moyai/raw/main/src/boom.mp4"},audioOnly:!0,paused:y,volume:Number(h(r.name,"volume"))}))})}catch{o<m&&setTimeout(()=>i(),o*1e3)}};setTimeout(()=>i(),300),l.before(H,"sendMessage",(c,[u,s],S)=>{s.content.toLowerCase().startsWith("b:")&&(s.content=s.content.slice(2,s.content.length)+"*\u200D*")}),l.before(q,"uploadLocalFiles",(c,[u,s,S,d],v)=>{d.content.toLowerCase().startsWith("b:")&&(d.content=d.content.slice(2,d.content.length)+"*\u200D*")})},onStop(){l.unpatchAll()},getSettingsPanel({settings:o}){return n.createElement(Q,{settings:o})}};D(J);
