function p(o,i,a){window.enmity.settings.set(o,i,a)}function w(o,i,a){return window.enmity.settings.get(o,i,a)}function _(o){window.enmity.plugins.registerPlugin(o)}function S(...o){return window.enmity.modules.getByProps(...o)}function L(...o){return window.enmity.modules.getByName(...o)}window.enmity.modules.common;const N=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const H=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const I=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function k(o){return window.enmity.patcher.create(o)}const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList,e.Image,e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const B=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch;const P=e.Text;e.TextInput,e.TouchableHighlight;const x=e.TouchableOpacity;e.TouchableWithoutFeedback,e.Touchable,e.View,e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon;const G=e.FormInput;e.FormLabel,e.FormRadio;const A=e.FormRow,R=e.FormSection;e.FormSelect,e.FormSubLabel,e.FormSwitch,e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;var V="Moyai",O="1.2.3",j="\u{1F5FF}",U=[{name:"Fiery",id:"890228870559698955"},{name:"Egg",id:"1015049434607927306"}],W={plugin:"https://github.com/Egg-Man-Real/Moyai/releases/latest/download/Moyai.js",manifest:"https://github.com/Egg-Man-Real/Moyai/releases/latest/download/manifest.json",changelog:"Fix Moyai Count",source:"https://github.com/Egg-Man-Real/Moyai"},z="#F47FFE",m={name:V,version:O,description:j,authors:U,updater:W,color:z};const K=S("DRMType","FilterType").default;function Q({settings:o}){const[i,a]=n.useState(!0),c=I.createThemedStyleSheet({item:{color:N.ThemeColorMap.HEADER_PRIMARY}});return n.useEffect(()=>{},[]),n.createElement(B,null,n.createElement(R,{title:"\u{1F5FF}"},n.createElement(G,{title:"Volume",placeholder:"69",keyboardType:"numeric",value:o.get("volume"),onChange:u=>o.set("volume",u)}),n.createElement(x,{onPress:()=>a(!1)},n.createElement(A,{label:"Test volume"}))),n.createElement(R,{title:"\u{1F5FF}"},n.createElement(A,{label:"Moyai Counter",subLabel:"This is probably innacurate (aka \u{1F5FF}\u{1F5FF}\u{1F5FF}\u{1F5FF})",trailing:()=>n.createElement(P,{style:c.item},Number(w(m.name,"moyaiCounter",0)))})),n.createElement(K,{source:{uri:"https://github.com/Egg-Man-Real/Moyai/raw/main/src/boom.mp4"},audioOnly:!0,paused:i,repeat:!0,onEnd:()=>a(!0),volume:Number(o.get("volume"))}))}const E=S("_currentDispatchActionType","_subscriptions","_actionHandlers","_waitQueue"),Y=L("ChatBanner",{default:!1}),$=S("DRMType","FilterType").default,q=S("uploadLocalFiles"),l=k("moyai");function C(o){return o=o.toLowerCase(),["\u{1F5FF}","moyai","moai","boom","vine","\u{1F4A5}","*\u200D*"].some(i=>o.includes(i))}const J={...m,onStart(){w(m.name,"volume")||p(m.name,"volume","1");let o=0;const i=3,a=()=>{var c,u,r;try{o++;for(const s of["MESSAGE_CREATE","MESSAGE_UPDATE","MESSAGE_REACTION_ADD"])try{E.dispatch({type:s,message:{}})}catch(y){console.log(`[${m.name} Dispatch Error]`,y)}const b=(c=E._actionHandlers._orderedActionHandlers)==null?void 0:c.MESSAGE_CREATE.find(s=>s.name==="MessageStore"),d=(u=E._actionHandlers._orderedActionHandlers)==null?void 0:u.MESSAGE_UPDATE.find(s=>s.name==="MessageStore"),v=(r=E._actionHandlers._orderedActionHandlers)==null?void 0:r.MESSAGE_REACTION_ADD.find(s=>s.name==="MessageStore");l.instead(Y,"default",(s,y,D)=>{const T=y[0].channel.id,[g,M]=n.useState(!0);let F;return l.before(b,"actionHandler",(h,t,f)=>{t[0].channelId===T&&t[0].message.content&&C(t[0].message.content)&&(F.seek(0),g&&M(!1),t[0].message.content=t[0].message.content.replace("*\u200D*"," \u{1F5FF}"),p(m.name,"moyaiCounter",Number(w(m.name,"moyaiCounter",0))+1/3))}),l.before(d,"actionHandler",(h,t,f)=>{t[0].channelId===T&&t[0].message.content&&C(t[0].message.content)&&(F.seek(0),g&&M(!1),t[0].message.content=t[0].message.content.replace("*\u200D*"," \u{1F5FF}"),p(m.name,"moyaiCounter",Number(w(m.name,"moyaiCounter",0))+1/3))}),l.after(v,"actionHandler",(h,t,f)=>{t[0].channelId===T&&C(t[0].emoji.name)&&(F.seek(0),g&&M(!1),p(m.name,"moyaiCounter",Number(w(m.name,"moyaiCounter",0))+1/3))}),n.createElement(n.Fragment,null,D.apply(s,y),n.createElement($,{ref:h=>{F=h},source:{uri:"https://github.com/Egg-Man-Real/Moyai/raw/main/src/boom.mp4"},audioOnly:!0,paused:g,volume:Number(w(m.name,"volume"))}))})}catch{o<i&&setTimeout(()=>a(),o*1e3)}};setTimeout(()=>a(),300),l.before(H,"sendMessage",(c,[u,r],b)=>{r.content.toLowerCase().startsWith("b:")&&(r.content=r.content.slice(2,r.content.length)+"*\u200D*")}),l.before(q,"uploadLocalFiles",(c,[u,r,b,d],v)=>{d.content.toLowerCase().startsWith("b:")&&(d.content=d.content.slice(2,d.content.length)+"*\u200D*")})},onStop(){l.unpatchAll()},getSettingsPanel({settings:o}){return n.createElement(Q,{settings:o})}};_(J);
